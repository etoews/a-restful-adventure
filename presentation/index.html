<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>A RESTful Adventure</title>

    <meta name="description" content="A REST workshop that guides participants through the design and implementation of a simple adventure game.">
    <meta name="author" content="Kurt Griffiths and Everett Toews">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/night.css" id="theme">
    <link rel="stylesheet" href="css/custom.css">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
        <section id="welcome">
          <h1>A RESTful Adventure</h1>
          <h2><a href="http://rack.to/rest">rack.to/rest</a></h2>
          <center>
            <table>
              <tbody>
                <tr>
                  <td>Kurt Griffiths</td>
                  <td><a href="https://twitter.com/kgriffs">@kgriffs</a></td>
                </tr>
                <tr>
                  <td>Everett Toews</td>
                  <td><a href="https://twitter.com/everett_toews">@everett_toews</a></td>
                </tr>
              </tbody>
            </table>
          </center>
          <aside class="notes">
            [15 sec]
            <ul>
              <li>Welcome to the RESTful Adventure workshop.</li>
              <li>[introduce the instructors]</li>
              <li>Over the next couple of hours we will take you on a journey through the creative process of designing and implementating a simple adventure game.</li>
            </ul>
          </aside>
        </section>

        <section>
          <h1>Goal</h1>
          <h3>Design and Implement</h3>
          <h3>a RESTful API</h3>
        </section>

        <section>
          <p>
            <span class="big">‚ò∫</span>
            <span class="fragment big">+ùì°</span>
            <span class="fragment big">=‚òÅ</span>
          </p>
          <aside class="notes">
            [30 sec]
            <ul>
              <li>You'll learn how to combine a user-oriented perspective with the principles of REST to create elegant web services.</li>
              <li>Web services that are elastic, maintainable and reliable.</li>
            </ul>
          </aside>
        </section>

        <section>
          <h1>Agenda</h1>
          <ol>
            <li><a href="#/rest">REST Fundamentals</a></li>
            <li><a href="#/design">Design the API</a></li>
            <li><a href="#/break">Break</a></li>
            <li><a href="#/impl">Implement the Design</a></li>
            <li><a href="#/conclusion">Conclusion</a></li>
            <li><a href="#/qa">Q &amp; A</a></li>
          </ol>
        </section>

        <section id="rest">
          <h1>REST Fundamentals</h1>
        </section>

        <section>
          <section>
            <img width="400" height="345" src="img/that-word-rest.jpg"/>
            <aside class="notes">

              <ul>
                <li>REST is often misunderstood</li>
              </ul>
            </aside>

          </section>

          <section>
            <img height="345" src="img/eniac.jpg"/>
            <aside class="notes">

              <ul>
                <li>So, before we go any further, we need to rewire our brains a little bit.</li>
              </ul>
            </aside>
          </section>
          <section>
            <h2>REST is not</h2>
            <p>
              <span class="fragment">[URL|RPC|CRUD] over </span> HTTP
            </p>
            <aside class="notes">
              <ul>
                <li>REST is not HTTP - HTTP APIs are not inherently RESTful.</li>
                <li>REST is not pretty URLs.</li>
                <li>REST is not RPC over HTTP. We aren't talking about calling remote functions on a server.</li>
                <li>And finally, REST is not simply a way to do CRUD over HTTP.</li>
              </ul>
            </aside>
          </section>
          <section>
            <h2>REST is</h2>
            <p class="fragment">An architectural style for network-based applications</p>
            <p class="fragment">A set of constraints formalized by Roy Fielding</p>
            <p class="fragment">A counterpoint to RPC</p>
            <aside class="notes">
              <ul>
                <li>REST is an architectural <em>style</em> that formalizes the concepts behind the way the web was intended to work. It acts as a guide for designing systems that embody the best characteristics of the web.</li>
                <li>REST was defined by one of the early pioneers of the web, Roy Fielding, in his doctoral dissertation.</li>
                <li>REST avoids the brittleness, scalability, and maintainability problems typical of RPC-based architectures. Rather than thinking about "functions" or "endpoints", as you would in RPC, you think in terms of "resources" and "hypermedia".</li>
              </ul>
            </aside>
          </section>
        </section>

        <section>
          <h2>Constraints</h2>
          <blockquote cite="http://www.brainyquote.com/quotes/quotes/w/waltwhitma136364.html">
            &ldquo;The shallow consider liberty a release from all law, from every constraint. The wise man sees in it, on the contrary, the potent Law of Laws.&rdquo;
          </blockquote>
          <p>- Walt Whitman</p>
          <aside class="notes">
            <ul>
              <li>REST is defined by a set of 6 architectural constraints.</li>
              <li>Taken together, these contraints provide a mold for RESTful applications.</li>
            </ul>
          </aside>
        </section>
        <section>
          <p>[TODO: pair down content to fit within time]</p>
          <ul class="no-bullets inline-h3">
            <li>üçú Client-Server</li>
            <li class="fragment">üêò Stateless</li>
            <li class="fragment">üì¶ Cache</li>
            <li class="fragment">üéπ Uniform Interface</li>
            <li class="fragment">üîó Layering</li>
            <li class="fragment">üéÆ Code-on-Demand</li>
          </ul>

          <aside class="notes">
            <ul>
              <li>Client-Server: This is all about creating a clear separation of concerns, which affords independent evolution and management between client and server. For example, when I sit down at my local Ramen shop, a server brings me a menu of options. I choose from the list of options and place my order. The server then goes off to interface with the backend kitchen services on my behalf. I don't need to know or care how my food is prepared, just that I get what I ordered in a timely manner.</li>
              <li>Stateless: This doesn't mean that your system has no state, just that there is no state shared between individual requests. Transports are unreliable, so you want to avoid embedding state in them. The client is like an elephant that never forgets; the client is responsible for remembering its own session state, and including that information in every request to the server. If a server goes down, a client should be able to provide its session state to a different server in the pool and get the same answer back as it would have from the failed box. If a client crashes or it's network connection fails, it should be able to pick up later where it left off.</li>
              <li>Cache: The idea here is to stock your goods as close to the consumer as possible, to reduce latency and transportation costs. For example, when I click "buy" on Amazon, the fulfillment system routes my order to the warehouse closest to my home that has my item in stock. Amazon regularly caches popular goods in warehouses as close to the consumer as they can get them. REST provides for caching by constraining systems to explicitly define caching parameters through the uniform interface.</li>
              <li>Uniform Interface: The idea here is to provide a set of ground-rules, an <em>a-priori</em> baseline of syntax and semantics. A pianist can sit down at any piano and know what to do. The mechanisms under the lid can and do vary wildly, but the meaning and layout of the keys remain the same. For REST this means a shared language of identifiers, methods, and media types.</li>
              <li>Layering: This extends Client-Server to create a chain of clients and servers, each exposing the same interface. It's like a recursive function. DNS works like this. When I want to find rackspace.com, I'll usually ask a local DNS server for the address. If the local DNS server doesn't know the IP address for my domain, it will act like a client and query another DNS server for the information, and so on and so forth.</li>
              <li>Code-on-Demand: This is an optional constaint that allows the server to delegate processing to clients when that is more efficient, and to also provide dynamic logic to augment the client's limited abilities to understand and process resources provided by the service. When it comes to the web, this constraint people usually equite code-on-demand to JavaScript, but there isn't any reason why it can't be used in other contexts. For example, game engines typically rely on scripts to orchestrate gameplay. These scripts can be delivered dynamically from the server to the client.</li>
            </ul>
          </aside>
        </section>

        <section>
          <h2>Elements of the Uniform Interface</h2>
        </section>

        <section>
          <p>[draw a big-picture diagram here, then point out the elements and talk about them briefly]</p>
          <p>[TODO: pair down content to fit within time]</p>

<!--
          <h3 class="fragment">Components</h3>
          <h3 class="fragment">Connectors</h3>
          <h3 class="fragment">Resources</h3>
          <h3 class="fragment">Representations</h3>
          <h3 class="fragment">Control Data</h3>
          <h3 class="fragment">Hypermedia</h3>
 -->
          <aside class="notes">
            <ul>
              <li>REST components categorize individual nodes into various roles, with each role conveying a specific set of expectations. Examples of components include origin servers, user agents, gateways, and proxies.</li>
              <li>REST connectors define the types of actions a node performs, such as caching or acting as a client or server. A given component may implement one or more connectors.</li>
              <li>Resources are client-facing models that map in some way to backend data entities. The mapping can be n-to-n and involve any number of transformations and amalgamations. Each resource is identified by a unique, opaque identifier, typically a URL. REST does not dictate a particular URL schema, although it can be helpful to adopt a human-friendly format, as we'll see later on. It's important to note here that the server has complete ownership of this identifier, which means that the client never constructs it, but simply "copies and pastes" identifiers it recieves from previous requests to the server. This makes it easier to evolve your API without breaking clients.</li>
              <li>Representations are snapshots of a resource at a point in time. A single resource can have multiple representations, such as JSON, PNG, or HTML. These representations are formalized as Internet media types. The client and server perform content negotiation to determine the desired representation.</li>
              <li>Control data is passed along with requests and responses to specify general semantics and to modify the default behavior of connectors. In HTTP, examples of control data include the HTTP method (e.g., GET and POST) and conditional headers, such as If-None-Match.</li>
              <li>Hypermedia is one of the most often ignored aspects of REST. This is ironic, because hypermedia is probably the most important difference between REST and other architectural styles, such as RPC. Rather than relying on brittle endpoint specifications, REST uses hypermedia to identify resources and provide a living web of links that clients traverse in order to change application state. The server may provide different links to the client according to the current state of the system. In this way, REST-based systems can be very flexible, allowing different components of the system to evolve somewhat independently.</li>
            </ul>
          </aside>
        </section>

        <section id="design">
          <h1>Design the API</h1>
        </section>

        <section>
          <h1>Before We Proceed</h1>
        </section>

        <section>
          <h1>Your REST != My REST</h1>

          <aside class="notes">
            <ul>
              <li>Keep calm. It's going to be okay. Be flexible.</li>
              <li>Often times a design decision needs to be made</li>
              <li>The important part is being consistent throughout your API</li>
              <li>Think programming style guide</li>
              <li>Examples:</li>
              <ul>
                <li>The way URLs are structured</li>
                <li>JSON resource schema</li>
                <li>Whether or not to use X headers</li>
              </ul>
            </ul>
          </aside>
        </section>

        <section>
          <img src="img/zork.jpg">
        </section>

        <section>
          <h1>Brainstorming</h1>

          <aside class="notes">
            <ul>
              <li>Draw some pictures</li>
              <li>Simple tools like text editors</li>
              <li>Identifying resources</li>
              <li>Typing out a list of URLs</li>
              <li>Mocking up some sample JSON resources</li>
            </ul>
          </aside>
        </section>

        <section>
          <h1>Lab</h1>
          <h2>Whiteboarding</h2>
        </section>

        <section>
          <h1>Use Cases</h1>

          <aside class="notes">
          	<ul>
          		<li>Who is your audience?</li>
							<li>Not necessarily designing the API for everyone</li>
							<li>Stick to known use cases without designing yourself into a corner</li>
						</ul>
          </aside>
        </section>

        <section>
          <h1>Example</h1>
          <p><a href="https://github.com/everett-toews/a-restful-adventure/blob/gh-pages/design/use-cases.md">Safely navigate a dungeon from start to finish</a></p>
        </section>

        <section>
          <h1>Early Technical Decisions</h1>
          <ul>
            <li>Media Types</li>
            <li>IDs vs hypermedia</li>
            <li>Pretty URLs</li>
            <li>Versioning</li>
            <li>Authentication</li>
            <li>Resource Updates</li>
            <li>(State Transitions)</li>
          </ul>

          <aside class="notes">
            <ul>
              <li>JSON vs. XML vs. YAML vs. Protocol Buffers. Pick one that meets your requirements. Default to YAML.</li>
              <li>I'll just pose a question on this one, how much does thinking of the data model implementation affect design of the API resources?</li>
              <li>It affects your URLs so you'll need to decide if you want them early on</li>
              <li>Not a solved problem and there's no de facto standard.</li>
              <li>Punt</li>
              <li>PUT or PATCH or JSON PATCH</li>
            </ul>
          </aside>
        </section>

        <section>
          <h1>API Definition</h1>
          <h1>Formats</h1>
          <ul>
            <li>API Blueprint</li>
            <li>RAML</li>
            <li>Swagger</li>
          </ul>

          <aside class="notes">
            <ul>
              <li>Formalize your thinking</li>
              <li>It's not documentation</li>
              <li>It's the contract between client and server</li>
            </ul>
          </aside>
        </section>

        <section>
          <img src="img/api-definition-contract.png">
          <p>Image Credit: <a href="http://apievangelist.com/2014/12/21/making-sure-the-most-important-layers-of-api-space-stay-open/">Kin Lane</a></p>

          <aside class="notes">
            <ul>
              <li>It drives the implementation of the client</li>
              <li>It drives the implementation of the server</li>
              <li>When it comes to the implementation of the server, there is a huge tempation to have the server generate the API defintion from code.</li>
              <li>But doing so makes it all too easy to break the API and your clients.</li>
              <li>Changes to the API definitions need to be considered carefully and communicated to clients.</li>
              <li>And any time you talk about API changes it begs the question of versioning, which will be touched on a bit later.</li>
            </ul>
          </aside>
        </section>

        <section>
          <h1>Swagger</h1>
          <h2><a href="https://github.com/swagger-api/swagger-spec">Spec</a></h2>

          <aside class="notes">
            <ul>
              <li>Chosen to learn more about it</li>
              <li>YAML and JSON. Built on JSON Schema</li>
              <li>It's certainly not perfect</li>
              <li>The spec can be hard to follow and there aren't examples of everything</li>
              <li>2.0 released late last year and not all of the tooling has caught up</li>
              <li>The editor has improved since we began creating this workshop</li>
              <li>Some of the 3rd party tools look like they're in good shape, particularly the Python stuff</li>
              <li>I'd also be very interested to hear from people who've worked with RAML and API Blueprint</li>
            </ul>
          </aside>
        </section>

        <section>
          <h1>Lab: Paths</h1>
          <pre><code data-trim>
swagger: "2.0"
info:
  version: 1.0.0
  title: A RESTful Adventure
host: localhost
schemes:
  - http
consumes:
  - application/json
produces:
  - application/json
paths:
  /characters:
  ???
          </code></pre>
        </section>

        <section>
          <h1>Lab: Examples</h1>
          <pre><code data-trim>
swagger: "2.0"
info:
  version: 1.0.0
  title: A RESTful Adventure
host: localhost
schemes:
  - http
consumes:
  - application/json
produces:
  - application/json
paths:
  /characters:
    get:
      responses:
        200:
          examples:
            application/json: |-
              {
                "?": "?"
                ...
              }
    post:
      x-examples:
        application/json: { "?": "?" }
      responses:
        201:
          examples:
            application/json: |-
              {
                "?": "?"
                ...
              }
          </code></pre>
        </section>

        <section>
          <h1>Lab: Models</h1>
          <pre><code data-trim>
swagger: "2.0"
info:
  version: 1.0.0
  title: A RESTful Adventure
host: localhost
schemes:
  - http
consumes:
  - application/json
produces:
  - application/json
paths:
  /characters:
    get:
      summary: List all Characters
      operationId: list_characters
      responses:
        200:
          description: An array of Characters
          schema:
            properties:
              characters:
                type: array
                $ref: "#/definitions/Characters"
          examples:
            application/json: |-
              {
                "characters": [
                  {
                    "id": "1234",
                    "name": "Knox Thunderbane",
                    "dungeon_id": "2345",
                    "room_id": "3456"
                  }
                ]
              }
    post:
      summary: Create a Character
      operationId: create_character
      parameters:
        - name: body
          in: body
          required: true
          schema:
            properties:
              name:
                type: string
                minLength: 1
                maxLength: 256
      x-examples:
        application/json: { "name": "Knox Thunderbane" }
      responses:
        201:
          description: Character created
          headers:
            Location:
              type: string
              format: url
              description: A link to the Character
          schema:
            $ref: "#/definitions/Character"
          # TODO: Do we want a top-level "character" key like we have with "characters"? e.g. { "character": {"id": 1234, ...}}
          examples:
            application/json: |-
              {
                "id": "1234",
                "name": "Knox Thunderbane"
              }
definitions:
  Character:
    type: object
    required:
      - ?
    properties:
      id:
        type: ?
        readOnly: ?
      name:
        type: ?
        minLength: ?
        maxLength: ?
      dungeon_id:
        type: ?
      room_id:
        type: ?
  Characters:
    type: array
    items:
      $ref: "#/definitions/Character"
          </code></pre>
        </section>

        <section>
          <h1>User-Centric</h1>

          <aside class="notes">
          	<ul>
          		<li>What kind of clients will you support?</li>
							<li>Writing some client code for those URLs</li>
							<li>curl</li>
							<li>mobile</li>
							<li>SDKs</li>
							<li>Writing some mock server code for those URLs</li>
							<li>Flask</li>
          	</ul>
          </aside>
        </section>

        <section>
          <h1>Lab: curl</h1>
          <pre><code data-trim>
HOST=http://localhost:5000

echo "Get characters"
curl ?

echo "Create a character"
curl ?
          </code></pre>
        </section>

        <section>
          <h1>Example</h1>
          <ul>
            <li>Client: <a href="https://github.com/everett-toews/a-restful-adventure/blob/gh-pages/src/client/curl-id-design.sh">curl</a></li>
            <li>Server: <a href="https://github.com/everett-toews/a-restful-adventure/blob/gh-pages/src/client/dcrawler.py">Flask</a></li>
          </ul>
        </section>

        <section>
          <h1>Documentation</h1>

          <aside class="notes">
            <ul>
              <li>APIs should as self documenting as possible</li>
              <li>Should be as machine readable as possible</li>
              <li>There will always be a semantic gap that requires human understanding</li>
              <li>This is where beautiful documentation comes in</li>
            </ul>
          </aside>
        </section>

        <section>
          <h1>Lab: API Doc</h1>
          <h2>Copy: <a href="https://raw.githubusercontent.com/everett-toews/a-restful-adventure/gh-pages/design/swagger-id-design.yaml">Swagger YAML</h2>
          <h2>Paste: <a href="http://editor.swagger.io/">Swagger Editor</a></h2>
        </section>

        <section>
          <h1>Errors</h1>

          <aside class="notes">
            <ul>
              <li>Good errors can make or break your API</li>
              <li>Take auth for example. It's the first thing developers go through and they always get it wrong the first time. If your error messages are bad, they will walk away and not come back.</li>
              <li>Give developers actionable errors. Include a URL to a web page where they can get more information. Include a team email address where they can get support.</li>
              <li>Include a transaction id for error response. Used to easily match an API user debugging their application to the errors on the server side, as discoverable by the operations team running the API.</li>
            </ul>
          </aside>
        </section>

        <section>
          <h1>Example</h1>

          <pre><code data-trim>
{
  "transaction_id": "71607e7c-df7c-45f3-b571-d1829de4ad9a",
  "code": "736.9",
  "title": "Teleport Denied",
  "description": "The room you tried to visit does not exist or is not accessible from your current room. Thought you could get away with it didn't you.",
  "link": {
      "rel": "help",
      "href": "http://en.wikipedia.org/wiki/No-teleportation_theorem"
    }
}
          </code></pre>
        </section>


        <section id="break">
          <h1>Break</h1>
        </section>

        <section id="impl">
          <h1>Implement the Design</h1>
        </section>

        <section>
          <h1>Add slides about implementation here</h1>
        </section>

        <section id="conclusion">
          <h1>Conclusion</h1>
        </section>

        <section>
          <h1>Add slides about conclusion here</h1>
        </section>

        <section>
          <h1>Rackspace API Working Group</h1>
        </section>

        <section id="qa">
          <h1>Thanks!</h1>
          <h2>Q &amp; A</h2>
        </section>
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
